{"title":"[odoo]开发环境配置","date":"2020-02-25T10:30:16.000Z","date_formatted":{"ll":"Feb 25, 2020","L":"02/25/2020","MM-DD":"02-25"},"link":"2020/02/25/odoo/odoo-开发环境配置","tags":["odoo"],"categories":["odoo"],"updated":"2020-02-25T08:12:36.958Z","content":"<h1 id=\"准备\">准备<a href=\"#准备\" title=\"准备\"></a></h1><ul><li><strong>odoo源代码</strong>，这个是必须的，当前使用<a href=\"https://github.com/odoo/odoo\" target=\"_blank\">odoo 13</a>,我采用的是直接下载13.0源代码的方式，这可以忽略odoo的git history，但后期通过pull源码打补丁也就有点复杂，这个在后面再考虑了</li>\n<li><strong>python 3.7.6</strong>，最开始我用的windows app store上的python，貌似有权限问题，查了一下，从官网重新下的python，我当时看到的最新的python版本是3.8+，但这个后来通过实践，应该是没法支持odoo 13，还是老实地用3.7.6</li>\n<li><strong>vscode</strong>，python我不是很熟，IDEA作为编辑器觉得有些重量级了，拿了vscode，先试试再说。记得要装python的插件</li>\n<li><strong>Odoo development cookbook</strong>, 这个算是入门书，比较合适，千万别看国内的翻译版，有些概念直译很难懂；我在<a href=\"https://www.packtpub.com/\" target=\"_blank\">Packpub</a>上买的，不算贵，$5；当前好像还没有13版的，就拿了12版的看了看，到目前为止，没有因为版本差异导致学不下来的；epub用MS edge还是很好的</li>\n<li><strong>docker</strong>，这应该不用说了，开发基本都要的，虽然这里只在上面起了一个postgres container，还是很方便</li>\n</ul><h1 id=\"当前环境\">当前环境<a href=\"#当前环境\" title=\"当前环境\"></a></h1><p>我用的windows 10，部分脚本没办法从cookbook上直接拷来用，有些要改成windows batch，但基本上改动都不会太复杂。</p>\n<h1 id=\"配置\">配置<a href=\"#配置\" title=\"配置\"></a></h1><ol><li>odoo的启动方式有很多种，包括直接安装到本机、从docker启动等等，官方的文档和cookbook里都有介绍。我们这里准备做开发，当前有很多东西不是很清楚，为了能够直接的查看odoo源码，了解odoo的设计机制，我们这里采用odoo source code + postgres container的方式带起来，此处可参考cookbook。</li>\n</ol><ul><li>通过init脚本可以生成配置文件<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%~dp0&#x2F;..&#x2F;env&#x2F;Scripts&#x2F;python.exe %~dp0&#x2F;..&#x2F;src&#x2F;odoo&#x2F;odoo-bin ^</span><br><span class=\"line\">-c %~dp0&#x2F;..&#x2F;odooae.cfg --stop-after-init ^</span><br><span class=\"line\">-d odoo ^</span><br><span class=\"line\">-i base ^</span><br><span class=\"line\">--save ^</span><br><span class=\"line\">--data-dir %~dp0&#x2F;..&#x2F;filestore ^</span><br><span class=\"line\">--addons-path %~dp0&#x2F;..&#x2F;src&#x2F;odoo&#x2F;odoo&#x2F;addons,%~dp0&#x2F;..&#x2F;src&#x2F;odoo&#x2F;addons,%~dp0&#x2F;..&#x2F;local,%~dp0&#x2F;..&#x2F;src&#x2F;partner-contact ^</span><br><span class=\"line\">--db_host&#x3D;localhost ^</span><br><span class=\"line\">--db_port&#x3D;8070 ^</span><br><span class=\"line\">--db_user&#x3D;odoo ^</span><br><span class=\"line\">--db_password&#x3D;odoo ^</span><br></pre></td></tr></table></figure></li>\n<li>通过start脚本可以启动odoo<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">%~dp0&#x2F;..&#x2F;env&#x2F;Scripts&#x2F;python.exe %~dp0&#x2F;..&#x2F;src&#x2F;odoo&#x2F;odoo-bin -c %~dp0&#x2F;..&#x2F;odooae.cfg</span><br></pre></td></tr></table></figure></li>\n</ul><ol><li>cookbook也推荐了python virtualenv，通过virtualenv可以较为轻松的创建独立的python环境，以满足不同项目的不同需求。</li>\n<li>为了保证vscode对python的自动补全功能，需要配置vscode项目参数，路径为./vscode/settings.json，我这里将odoo源码路径加了进去。<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    &quot;python.pythonPath&quot;: &quot;env\\\\Scripts\\\\python.exe&quot;,</span><br><span class=\"line\">    &quot;python.autoComplete.extraPaths&quot;: [&quot;D:\\\\6.faststep\\\\odoo\\\\odoo-dev\\\\odooae\\\\src\\\\odoo&quot;]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n<li>我们在这里用使用git管理源代码，通过配置，我们应当只track自己的项目代码，基本上是odoo module代码，而odoo的代码或者第三方插件的代码都不做跟踪，如果考虑方便后期直接打补丁，那么可以直接git clone这些代码。</li>\n</ol>","next":{"title":"Hello World","link":"2020/02/05/hello-world"},"plink":"http://thewalk.github.io/2020/02/25/odoo/odoo-开发环境配置/","toc":[{"id":"准备","title":"准备","index":"1"},{"id":"当前环境","title":"当前环境","index":"2"},{"id":"配置","title":"配置","index":"3"}]}